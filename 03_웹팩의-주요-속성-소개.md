## 웹팩의 주요 속성 소개

### 웹팩의 4가지 주요 속성

- entry
- output
- loader
- plugin

<br />

### entry

`entry` 속성은 웹팩에서 웹 자원을 변환하기 위해 필요한 '최초 진입점'이자, 자바스크립트 파일 경로이다.

```js
// webpack.config.js
module.exports = {
  entry: "./src/index.js",
};
```

> 웹팩을 실행했을 때, `src` 폴더 밑의 `index.js`를 대상으로 웹팩이 빌드를 수행하는 코드이다.

```js
entry: {
  login: "./src/LoginView.js",
  main: "./src/MainView.js",
}
```

> entry는 여러 개가 될 수도 있다.<br />
> 싱글 페이지 애플리케이션이 아닌 특정 페이지로 진입했을 때 서버에서 해당 정보를 내려주는 형태의 멀티 페이지 애플리케이션에 적합하다.

<br />

### output

`output` 속성은 웹팩을 돌리고 난 결과물의 파일 경로를 의미한다.

```js
// webpack.config.js
module.exports = {
  output: {
    filename: "bundle.js",
  },
};
```

> `entry` 속성과는 달리 객체 형태로 옵션들을 추가해야 한다.

#### Output 속성 옵션 형태

```js
const path = require("path");

module.exports = {
  output: {
    filename: "bundle.js",
    path: path.resolve(__dirname, "./dist"),
  },
};
```

#### Output 파일 이름 옵션

- 결과 파일 이름에 `entry` 속성을 포함하는 옵션

  ```js
  module.export = {
    output: {
      filename: "[name].bundle.js",
    },
  };
  ```

- 결과 파일 이름에 웹팩 내부적으로 사용하는 모듈 `id`를 포함하는 옵션

  ```js
  module.export = {
    output: {
      filename: "[id].bundle.js",
    },
  };
  ```

- 매 빌드시 마다 고유 해시 값을 붙이는 옵션

  ```js
  module.export = {
    output: {
      filename: "[name].[hash].bundle.js",
    },
  };
  ```

- 웹팩의 각 모듈 내용을 기준으로 생성된 해시 값을 붙이는 옵션

  ```js
  module.export = {
    output: {
      filename: "[chunkhash].bundle.js",
    },
  };
  ```

  > 이렇게 생성된 결과 파일의 이름에는 각각 엔트리 이름, 모듈 아이디, 해시 값등이 포함된다.

<br />

### loader

`loader`는 웹팩이 웹앱을 변환(resolve)할 때, 자바스크립트 파일이 아닌 웹 자원(html, css, images, 폰트 등)을 변환할 수 있도록 도와주는 속성이다.

```js
// webpack.config.js
module.exports = {
  module: {
    rules: [],
  },
};
```

> `entry`나 `output` 속성과는 다르게 `module`이라는 이름을 사용한다.

#### loader가 필요한 이유

```js
// app.js
import "./common.css";

console.log("css loaded");
```

```css
/* common.css */
p {
  color: blue;
}
```

```js
// webpack.config.js
module.exports = {
  entry: "./app.js",
  output: {
    filename: "bundle.js",
  },
};
```

❌ `app.js`를 웹팩으로 빌드하면 `app.js`에서 임포트한 `common.css` 파일을 해석하기 위해 적절한 loader를 추가해달라는 에러가 발생한다.<br />

<br />

#### CSS loader 적용하기

```
$ npm i css-loader -D
```

```js
// webpack.config.js
module.exports = {
  entry: "./app.js",
  output: {
    filename: "bundle.js",
  },
  module: {
    rules: [
      {
        test: /\.css$/, // 로더를 적용할 파일 유형 (일반적으로 정규 표현식을 사용한다.)
        use: ["css-loader"], // (해당 파일에 적용할 로더의 이름)
      },
    ],
  },
};
```

> 모든 css 파일에 대해서 css 로더를 적용하겠다는 의미.<br />
> 빌드 후 실행하면 정상동작하는 것을 확인할 수 있다.

<br />

#### 자주 사용되는 로더 종류

> [https://webpack.js.org/loaders/](https://webpack.js.org/loaders/)

- [Babel Loader](https://webpack.js.org/loaders/babel-loader/#root)
- [Sass Loader](https://webpack.js.org/loaders/sass-loader/#root)
- [File Loader(v4)](https://v4.webpack.js.org/loaders/file-loader/)
- [TS Loader](https://webpack.js.org/guides/typescript/#loader)

loader를 여러 개 사용하는 경우 `rules`배열에 loader 옵션 객체를 추가하면 된다.

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/,
        use: ["css-loader"],
      },
      {
        test: /\.ts$/,
        use: ["ts-loader"],
      },
    ],
  },
};
```

<br />

#### 로더 적용 순서

'특정 파일'에 여러 개의 loader를 사용하는 경우 '로더가 적용되는 순서'에 주의해야 한다.<br />
로더는 기본적으로 '오른쪽에서 왼쪽 순으로 적용' 된다.

- scss 로더 적용 예시.

  ```js
  module: {
    rules: [
      {
        test: /\.scss$/,
        use: ["css-loader", "sass-loader"],
      },
    ];
  }
  ```

  > scss파일에 대해 먼저 `sass-loader`로 scss파일을 css파일로 변환하는 전처리를 한 다음 웹팩에서 css파일을 인식할 수 있게 `css-loader`를 적용하는 코드이다.

  만약 해당 css파일이 웹 애플리케이션에서 인라인 스타일 태그로 추가되는 것을 원한다면 아래와 같이 [`style-loader`](https://webpack.js.org/loaders/style-loader/#root)도 추가할 수 있다.

  ```js
  {
    test: /\.scss$/,
    use: ["style-loader", "css-loader", "sass-loader"],
  }
  ```

  특정 로더에 대한 옵션을 포함한 형태로도 입력할 수 있다.

  ```js
  {
    test: /\.scss$/,
    use: [
      {
        loader: "style-loader",
      },
      {
        loader: "css-loader",
        options: { modules: true },
      },
      {
        loader: "sass-loader",
      }
    ],
  }
  ```

  > `use: []`에 `{}` 형태로.
